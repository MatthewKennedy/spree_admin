///////////////
// DARK MODE //
///////////////
@media (prefers-color-scheme: dark) {
  :root body.admin {
    * {
      --perceived-lightness:  calc( ((var(--label-r) * 0.2126) + (var(--label-g) * 0.7152) + (var(--label-b) * 0.0722)) / 255 );
      --lightness-switch:     max(0, min(calc((var(--perceived-lightness) - var(--lightness-threshold)) * -1000), 1));
      --lighten-by:           calc(((var(--lightness-threshold) - var(--perceived-lightness)) * 100) * var(--lightness-switch));
    }

////////////////
// RGB VALUES //
////////////////

    // Brand
    --bs-brand-color-rgb:        250, 84, 0;

    // Primary
    --bs-primary-rgb:            83, 155, 245;
    --bs-primary-hover-rgb:      var(--bs-primary-rgb);

   // Secondary
    --bs-secondary-rgb:          55, 62, 71;
    --bs-secondary-hover-rgb:    68, 76, 86;

    // Danger
    --bs-danger-rgb:             255, 0, 24;
    --bs-danger-hover-rgb:       255, 0, 24;

    // Body
    --bs-body-color-rgb:         207, 207, 207;
    --bs-body-bg-rgb:            28, 33, 40;

    // Sub Colors, used for Cards
    --bs-sub-bg-rgb:             34, 39, 46;
    --bs-sub-border-rgb:         68, 76, 86;
    --bs-sub-color-rgb:          34, 39, 46;

    // Input
    --bs-input-bg-rgb:           28, 33, 40;
    --bs-input-border-rgb:       68, 76, 86;
    --bs-input-color-rgb:        255, 255, 255;

    --bs-input-focus-border-rgb: 83, 155, 245;


////////////////
// POLYFILL   //
////////////////

    // Converting RGB values colors where appropriate
    --bs-gradient:                    linear-gradient(180deg, rgba(var(--bs-body-color-rgb), 0.15), rgba(var(--bs-body-color-rgb), 0));

    --bs-border-color:                rgba(var(--bs-secondary-rgb));
    --bs-border-color-translucent:    rgba(var(--bs-black-rgb), 0.175);

    --bs-link-color:                  rgba(var(--bs-primary-rgb));
    --bs-link-hover-color:            rgba(var(--bs-primary-hover-rgb));

    --sa-logo:                               rgba(var(--bs-brand-color-rgb));
    --sa-navbar-bg:                          rgba(var(--bs-body-bg-rgb));
    --sa-sidebar-bg:                         rgba(var(--bs-body-bg-rgb));


///////////////////
// UI COMPONENTS //
///////////////////
    .btn-primary {
      --bs-btn-color:                 rgba(var(--bs-primary-rgb), 0.9);
      --bs-btn-bg:                    rgba(var(--bs-primary-rgb), .06);
      --bs-btn-border-color:          rgba(var(--bs-primary-rgb), 0.9);

      --bs-btn-hover-color:           rgba(var(--bs-primary-rgb), 1);
      --bs-btn-hover-bg:              rgba(var(--bs-primary-rgb), .13);
      --bs-btn-hover-border-color:    rgba(var(--bs-primary-rgb));

      --bs-btn-focus-shadow-rgb:      var(--bs-primary-bg-rgb);

      --bs-btn-active-color:          rgba(var(--bs-gray-100));
      --bs-btn-active-bg:             rgba(var(--bs-primary-rgb), .5);
      --bs-btn-active-border-color:   rgba(var(--bs-primary-hover-rgb));

      --bs-btn-disabled-color:        rgba(var(--bs-primary-rgb), 0.4);
      --bs-btn-disabled-bg:           rgba(var(--bs-primary-rgb), 0);
      --bs-btn-disabled-border-color: rgba(var(--bs-primary-rgb), 0.4);
    }

    .btn-secondary {
      --bs-btn-color:                 var(--bs-gray-500);
      --bs-btn-bg:                    rgba(var(--bs-secondary-rgb), .1);
      --bs-btn-border-color:          rgba(var(--bs-secondary-rgb));

      --bs-btn-hover-color:           rgba(var(--bs-gray-300));
      --bs-btn-hover-bg:              rgba(var(--bs-secondary-rgb), .2);
      --bs-btn-hover-border-color:    rgba(var(--bs-secondary-hover-rgb));

      --bs-btn-focus-shadow-rgb:      var(--bs-secondary-bg-rgb);

      --bs-btn-active-color:          rgba(var(--bs-gray-100));
      --bs-btn-active-bg:             rgba(var(--bs-secondary-rgb), .5);
      --bs-btn-active-border-color:   rgba(var(--bs-secondary-hover-rgb));

      --bs-btn-disabled-color:        var(--bs-gray-700);
      --bs-btn-disabled-bg:           rgba(var(--bs-secondary-rgb), 0);
      --bs-btn-disabled-border-color: rgba(var(--bs-secondary-rgb));
      --bs-btn-disabled-opacity:      1;
    }

    .btn-danger {
      --bs-btn-color:                 rgba(var(--bs-danger-rgb), 0.6);
      --bs-btn-bg:                    rgba(var(--bs-danger-rgb), .06);
      --bs-btn-border-color:          rgba(var(--bs-danger-rgb), 0.6);

      --bs-btn-hover-color:           rgba(var(--bs-danger-rgb), 1);
      --bs-btn-hover-bg:              rgba(var(--bs-danger-rgb), .13);
      --bs-btn-hover-border-color:    rgba(var(--bs-danger-rgb));

      --bs-btn-focus-shadow-rgb:      var(--bs-danger-bg-rgb);

      --bs-btn-active-color:          rgba(var(--bs-gray-100));
      --bs-btn-active-bg:             rgba(var(--bs-danger-rgb), .5);
      --bs-btn-active-border-color:   rgba(var(--bs-danger-hover-rgb));

      --bs-btn-disabled-color:        rgba(var(--bs-dark-rgb));
      --bs-btn-disabled-bg:           rgba(var(--bs-danger-rgb));
      --bs-btn-disabled-border-color: rgba(var(--bs-danger-rgb));
    }

    .btn-closer {
      --bs-btn-color:                 var(--bs-gray-100);
      --bs-btn-bg:                    transparent;
      --bs-btn-border-color:          transparent;

      --bs-btn-hover-color:           var(--bs-gray-300);
      --bs-btn-hover-bg:              transparent;
      --bs-btn-hover-border-color:    transparent;

      --bs-btn-focus-shadow-rgb:      transparent;

      --bs-btn-active-color:          var(--bs-gray-300);
      --bs-btn-active-bg:             transparent;
      --bs-btn-active-border-color:   transparent;

      --bs-btn-disabled-color:        var(--bs-gray-500);
      --bs-btn-disabled-bg:           transparent;
      --bs-btn-disabled-border-color: transparent;
    }



    .accordion {
      --bs-accordion-color:        rgba(var(--bs-body-color-rgb));
      --bs-accordion-bg:           rgba(var(--bs-body-bg-rgb));
      --bs-accordion-active-color: rgba(var(--bs-primary-rgb));
      --bs-accordion-btn-color:    rgba(var(--bs-body-color-rgb));
      --bs-accordion-active-bg:    rgba(var(--bs-sub-bg-rgb));

      &-button {
        &:after {
          background-image: url("data:image/svg+xml; charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='currentColor' %3E%3Cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3E%3C/svg%3E");
        }
        &:not(.collapsed):after{
          background-image: url("data:image/svg+xml; charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='currentColor' %3E%3Cpath fill-rule='evenodd' d='M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z'/%3E%3C/svg%3E");
        }
      }
    }

    .badge.danger {
      --label-r: 220;
      --label-g: 53;
      --label-b: 69;
      --label-h: 354;
      --label-s: 70;
      --label-l: 53;
    }

    .badge.brand {
      --label-r: 250;
      --label-g: 84;
      --label-b: 0;
      --label-h: 20;
      --label-s: 100;
      --label-l: 49;
    }

    .badge.primary {
      --label-r: 83;
      --label-g: 155;
      --label-b: 245;
      --label-h: 213;
      --label-s: 89;
      --label-l: 64.3;
    }

    .badge.info {
      --label-r: 83;
      --label-g: 155;
      --label-b: 245;
      --label-h: 213;
      --label-s: 89;
      --label-l: 64.3;
    }

    .badge.success {
      --label-r: 25;
      --label-g: 135;
      --label-b: 84;
      --label-h: 152;
      --label-s: 68;
      --label-l: 31;
    }

    .badge.warning {
      --label-r: 247;
      --label-g: 223;
      --label-b: 30;
      --label-h: 53;
      --label-s: 93;
      --label-l: 54;
    }

    .badge.normal {
      --label-r: 191;
      --label-g: 212;
      --label-b: 242;
      --label-h: 215;
      --label-s: 66;
      --label-l: 84;
    }

    .badge.muted {
      --label-r: 0;
      --label-g: 0;
      --label-b: 0;
      --label-h: 0;
      --label-s: 0;
      --label-l: 0;
    }

    .badge {
      --lightness-threshold:  0.6;
      --background-alpha:     0.18;
      --border-alpha:         0.3;
    }

    .card {
      --bs-card-bg: rgba(var(--bs-sub-bg-rgb));
      --bs-card-border-color: rgba(var(--bs-sub-border-rgb));
    }

    .dropdown{
      &-menu {
        --bs-dropdown-bg: rgba(var(--bs-sub-bg-rgb));
        --bs-dropdown-border-color: rgba(var(--bs-sub-border-rgb));
      }
      &-item {
        --bs-dropdown-link-color: rgba(var(--bs-body-color-rgb));

        &:hover {
          background-color: rgba(var(--bs-body-bg-rgb));
          color: rgba(var(--bs-body-color-rgb));
        }
      }
    }

    .form-control,
    .form-select,
    .form-check-input {
      background-color: rgba(var(--bs-input-bg-rgb));
      border-color: rgba(var(--bs-input-border-rgb));
      color: rgba(var(--bs-input-color-rgb));

      &:focus-visible,
      &:focus,
      &:checked,
      &:has( > div.ProseMirror:focus) {
        border-color: rgba(var(--bs-input-focus-border-rgb));
        box-shadow: inset 0 0 0 1px rgba(var(--bs-input-focus-border-rgb));
      }
    }

    .plugin-dropdown_input.focus .ts-dropdown .dropdown-input {
      color: white;
      border-color: rgba(var(--bs-input-focus-border-rgb));
      box-shadow: inset 0 0 0 1px rgba(var(--bs-input-focus-border-rgb));
    }

    .input-group-text {
      background-color: rgba(var(--bs-input-bg-rgb));
      border-color: rgba(var(--bs-input-border-rgb));
      color: rgba(var(--bs-input-color-rgb));
    }

    .list-group {
      background-color: rgba(var(--bs-body-bg-rgb));
    }

    .list-group-item {
      background-color: rgba(var(--bs-body-bg-rgb));
    }

    .modal-content {
      background-color: rgba(var(--bs-sub-bg-rgb));
      border-color: rgba(var(--bs-sub-border-rgb));
    }

    .modal-backdrop.show {
      --bs-backdrop-opacity: 0.75;
    }

    .offcanvas {
      --bs-offcanvas-bg: rgba(var(--bs-body-bg-rgb));
    }

    .toast.success,
    .toast.notice {
      --bs-toast-bg:            rgba(59, 65, 75);
      --bs-toast-color:         rgba(191, 209, 238);
      --bs-toast-border-color:  rgba(99, 109, 124);
    }

    .toast.error {
      --bs-toast-bg:            rgba(var(--bs-danger-rgb), .75);
      --bs-toast-color:         rgba(var(--bs-white-rgb));
      --bs-toast-border-color:  rgba(var(--bs-danger-rgb));
    }

    aside#main-sidebar {
      li.selected {
        background-color: rgba(var(--bs-primary-rgb), .04);
      }
    }
  }
}
